<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>‚ù§Ô∏è</title>
  <meta name="description" content="Secreto." />
  <!-- Open Graph / Twitter for compartir -->
  <meta property="og:type" content="website" />
  <meta property="og:title" content="‚ù§Ô∏è" />
  <meta property="og:description" content="Secreto." />
  <meta property="og:image" content="img/marta-preparacion.jpg" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="‚ù§Ô∏è" />
  <meta name="twitter:description" content="Secreto." />
  <meta name="twitter:image" content="img/marta-preparacion.jpg" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{ --bg1:#ffdde1; --bg2:#ee9ca7; --card:#ffffffee; --text:#221b2c; --accent:#ff4d6d; --muted:#6b6b6b; }
    *{box-sizing:border-box}
    html,body{ margin:0; font-family:'Poppins',system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,sans-serif; color:var(--text);
      background: linear-gradient(135deg, var(--bg1), var(--bg2)); display:flex; align-items:center; justify-content:center; padding:16px; min-height:100vh;}
    body{ margin:0; font-family:'Poppins',system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,sans-serif; color:var(--text);
      background: linear-gradient(135deg, var(--bg1), var(--bg2)); display:flex; align-items:center; justify-content:center; padding:24px;}
    .app{width:min(100%,1100px);} .card{ background:var(--card); backdrop-filter: blur(6px); border-radius:24px; box-shadow:0 20px 60px #00000025; overflow:hidden; text-align:center;}
    header{ padding:16px 20px; background:#ffffffaa;}
    @media (min-width:700px){ header{ padding:22px 26px; } }
    header h1{margin:0; font-size:clamp(22px,3.2vw,34px); font-weight:700; letter-spacing:.3px}
    .grid{display:grid; grid-template-columns:1fr; gap:0;}
    .left{padding:22px; display:flex; flex-direction:column; gap:16px; align-items:center;}
    .message{font-size:clamp(16px,2.4vw,22px); line-height:1.45; background:#fff; padding:16px 18px; border-radius:18px; position:relative; box-shadow:0 8px 24px #00000014; max-width:620px;}
    .message small{display:block; margin-top:10px; font-size:12px; color:var(--muted)}
    .prep-photo{max-width:min(380px,70vw); width:100%; height:auto; border-radius:18px; margin:8px 0; box-shadow:0 8px 24px #00000033; object-fit:cover;}
    .right{position:relative; min-height:360px; overflow:hidden}
    .slideshow{position:relative; height:100%;}
    .slide{ position:absolute; inset:0; background:#ddd center/cover no-repeat; opacity:0; transition:opacity 800ms ease;}
    .slide.active{opacity:1}
    .credit{position:absolute; right:12px; bottom:8px; color:#ffffffcc; font-size:12px; text-shadow:0 1px 2px #00000055}
    .hearts{position:absolute; inset:0; pointer-events:none; overflow:hidden}
    .heart{position:absolute; font-size:18px; opacity:.8; animation: float 8s linear infinite;}
    @keyframes float{0%{transform:translateY(40px) scale(.8); opacity:0} 10%{opacity:1} 100%{transform:translateY(-110%) scale(1.3); opacity:0}}
    footer{padding:16px 22px; font-size:12px; color:var(--muted); text-align:center}
    /* Centrado especial en modo preparaci√≥n */
    .prep #main-content{display:flex; align-items:center; justify-content:center;}
    .prep .right{display:none}
  </style>
</head>
<body>
  <div class="app card" id="app">
    <header>
      <h1 id="title">‚ù§Ô∏è</h1>
    </header>

    <div class="grid" id="main-content">
      <section class="left">
        <div class="message" id="message" role="status">
          <span id="message-text">Ya queda menos para abrazarte üíï</span>
          <small id="message-meta"></small>
        </div>
        <img src="marta-preparacion.jpg" alt="Foto especial de Marta" class="prep-photo" id="prep-photo" style="display:none">
        <div class="message" id="prep-message" style="display:none">Estoy preparando algo especial para ti, Marta‚Ä¶ ‚ú®</div>
      </section>

      <section class="right">
        <div class="slideshow" id="slideshow"></div>
        <div class="hearts" id="hearts"></div>
        <div class="credit" id="credit"></div>
      </section>
    </div>

    <footer id="footer">Hecho con ‚ù§Ô∏è para Marta</footer>
  </div>

  <script>
    const CONFIG = {
      startDate: "2025-09-23T00:00:00",
      targetDate: "2025-12-31T00:00:00",
      messages: [
        "Cada d√≠a que pasa estamos m√°s cerca, Marta.",
        "Pronto nos volveremos a abrazar, Marta.",
        "El Erasmus termina, nuestro amor contin√∫a.",
        "Te echo de menos, Marta, pero la espera vale la pena.",
        "Ya casi estamos juntos otra vez ‚ù§Ô∏è",
      ],
      messageMeta: ["", "", "", "", ""],
      messageStartDate: "2025-09-23",
      photos: [
        { src: "https://images.unsplash.com/photo-1518600506278-4e8ef466b810?q=80&w=1600&auto=format&fit=crop", credit: "Unsplash" },
        { src: "https://images.unsplash.com/photo-1491438590914-bc09fcaaf77a?q=80&w=1600&auto=format&fit=crop", credit: "Unsplash" },
        { src: "https://images.unsplash.com/photo-1516826957135-700dedea698c?q=80&w=1600&auto=format&fit=crop", credit: "Unsplash" },
      ],
      hearts: 18
    };

    const $ = (id) => document.getElementById(id);
    const msgEl = $("message-text"), metaEl=$("message-meta");
    const slideshow = $("slideshow");
    const credit = $("credit");
    const footer = $("footer");
    const prepPhoto = $("prep-photo");
    const prepMessage = $("prep-message");

    const start = new Date(CONFIG.startDate);
    const now = new Date();

    if(now < start){
      // Modo preparaci√≥n centrado
      document.body.classList.add('prep');
      msgEl.style.display = "none";
      prepPhoto.style.display = "block";
      prepMessage.style.display = "block";
      footer.textContent = "Con todo mi cari√±o ‚ù§Ô∏è";
      $("slideshow").style.display = "none";
    } else {
      let msgIdx = 0;
      function showMessage(i){
        msgIdx = (i + CONFIG.messages.length) % CONFIG.messages.length;
        msgEl.textContent = CONFIG.messages[msgIdx];
        metaEl.textContent = CONFIG.messageMeta?.[msgIdx] || '';
      }
      function initDailyMessages(){
        const now = new Date();
        const start = CONFIG.messageStartDate ? new Date(CONFIG.messageStartDate) : new Date();
        start.setHours(0,0,0,0);
        const days = Math.floor((now - start)/86400000);
        showMessage(days);
        const nextMidnight = new Date(now); nextMidnight.setHours(24,0,0,0);
        setTimeout(()=>{
          showMessage(msgIdx+1);
          setInterval(()=> showMessage(msgIdx+1), 24*60*60*1000);
        }, nextMidnight - now);
      }
      initDailyMessages();

      let imgIdx = 0;
      const slides = CONFIG.photos.map((p, i)=>{
        const div = document.createElement('div');
        div.className = 'slide';
        div.style.backgroundImage = `url("${p.src}")`;
        if(i===0) div.classList.add('active');
        slideshow.appendChild(div);
        return div;
      });
      function showPhoto(i){
        imgIdx = (i+CONFIG.photos.length) % CONFIG.photos.length;
        slides.forEach((s, k)=> s.classList.toggle('active', k===imgIdx));
        credit.textContent = CONFIG.photos[imgIdx].credit || '';
      }
      function initDailyPhotos(){
        const now = new Date();
        const start = CONFIG.messageStartDate ? new Date(CONFIG.messageStartDate) : new Date();
        start.setHours(0,0,0,0);
        const days = Math.floor((now - start)/86400000);
        showPhoto(days);
        const nextMidnight = new Date(now); nextMidnight.setHours(24,0,0,0);
        setTimeout(()=>{
          showPhoto(imgIdx+1);
          setInterval(()=> showPhoto(imgIdx+1), 24*60*60*1000);
        }, nextMidnight - now);
      }
      initDailyPhotos();

      const hearts = document.getElementById('hearts');
      function spawnHeart(){
        const h = document.createElement('div');
        h.className='heart';
        h.textContent = Math.random() < .3 ? 'üíò' : (Math.random()<.5 ? 'üíñ' : '‚ù§Ô∏è');
        h.style.left = Math.round(Math.random()*100)+"%";
        h.style.animationDuration = (6 + Math.random()*6) + 's';
        h.style.fontSize = (14 + Math.random()*18) + 'px';
        hearts.appendChild(h);
        setTimeout(()=> h.remove(), 12000);
      }
      for(let i=0;i<CONFIG.hearts;i++) setTimeout(spawnHeart, i*400);
      setInterval(spawnHeart, 1200);
    }
  </script>
</body>
</html>
